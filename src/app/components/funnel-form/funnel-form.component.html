<form class="p-3 flex flex-col align items-start bg-slate-200">
  <div class="w-full flex justify-between">
    <div class="text-nowrap font-bold">CUSTOMER FILTER</div>
    <div class="flex justify-center">
      <button
        type="button"
        class="!text-red-500"
        mat-button
        (click)="discardSteps()"
      >
        Discard filters
      </button>
    </div>
  </div>

  <!-- EVENTS / STEPS -->
  <div class="w-full p-3 flex flex-col bg-white">
    <ng-container *ngFor="let step of form.controls; let stepIndex = index">
      <div>
        <div class="font-bold">
          {{ stepIndex + 1 }}. {{ step.controls.name.value }}
        </div>

        <div class="mt-2 w-full flex flex-grow justify-between items-center">
          <div>
            <mat-form-field>
              <mat-select
                [formControl]="step.controls.event"
                (selectionChange)="changeStepName(stepIndex, $event.value)"
              >
                @for (eventOption of eventOptions; track eventOption) {
                <mat-option [value]="eventOption">{{ eventOption }}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          </div>

          <div class="flex flex-grow justify-end">
            <div
              mat-icon-button
              color="primary"
              (click)="deleteStep(stepIndex)"
            >
              <mat-icon>delete</mat-icon>
            </div>
          </div>
        </div>

        <hr class="divide-y-2" />
      </div>
    </ng-container>

    <div class="w-full flex justify-center">
      <button
        type="button"
        class="!text-blue-500"
        mat-button
        (click)="addStep()"
      >
        + Add Funnel Step
      </button>
    </div>
  </div>

  <div class="mt-3 text-red-500">
    <button
      type="button"
      mat-flat-button
      class="!bg-yellow-400"
      (click)="onSubmit()"
    >
      Apply filters
    </button>
  </div>
</form>

<div>{{ form.value | json }}</div>
